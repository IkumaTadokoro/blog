---
import Time from "../../../shared/ui/time/index.astro";
import "../../../shared/ui/markdown/index.css";
import { render } from "astro:content";
import type { BlogEntry } from "../../../entities/blog/model/schema";
import Tags from "./tags.astro";
import Toc from "./toc.astro";
import Writer from "./writer.astro";

interface Props {
  entry: BlogEntry;
}

const { entry } = Astro.props;

const {
  data: { title, publishDate, draft, tags },
} = entry;
const { Content, headings } = await render(entry);
---

<div class="grid grid-rows-[1fr_max-content] gap-x-8 min-h-full">
  <div class={"space-y-8 sm:space-y-16 my-8 sm:my-16"}>
    {
      draft && (
        <p class="text-center mb-8 p-4 text-foreground font-semibold">
          !!!この記事は下書きです。本番環境では表示されません。!!!
        </p>
      )
    }
    <hgroup class="space-y-4 text-center">
      <h2
        class="text-foreground text-heading-20 sm:text-heading-32 font-bold break-all tracking-widest !leading-relaxed"
      >
        {title}
      </h2>
      <Time date={publishDate} />
    </hgroup>
    <div
      class="grid grid-cols-1 lg:grid-cols-[1fr_16rem] gap-x-8 lg:mr-[-16rem]"
    >
      <article class={"break-all prose"}>
        <Content />
      </article>
      <aside class="hidden lg:grid grid-rows-[max-content_1fr]">
        <div class="sticky top-4 space-y-12">
          <Toc headings={headings} />
          <Tags tags={tags} />
          <Writer />
        </div>
      </aside>
    </div>
  </div>
  <aside class="block lg:hidden">
    <Writer />
  </aside>
</div>
